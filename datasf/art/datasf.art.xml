<?xml version="1.0" encoding="UTF-8"?>
<table xmlns="http://query.yahooapis.com/v1/schema/table.xsd">
    <meta>
        <author>Clarence Leung (Yahoo Inc.)</author>
        <description>This data set includes all of the publicly-sited works in the Civic Art Collection, which includes historic monuments, murals, and artworks commissioned through the City's Public Art Program. The data set includes the following categories: artist name, title of work, medium, dimensions and location.</description>
        <documentationURL>https://data.sfgov.org/Arts-Culture-and-Recreation-/SF-Civic-Art-Collection/zfw6-95su</documentationURL>
        <apiKeyURL>http://dev.socrata.com/authentication</apiKeyURL>
        <sampleQuery>SELECT * from datasf.art WHERE medium='oil' AND source='San Francisco Arts Commission';</sampleQuery>
    </meta>
    <bindings>
        <select itemPath="">
            <urls>
                <url>http://data.sfgov.org/resource/zfw6-95su.json</url>
            </urls>
            <inputs>
                <key id="accession_id" as="id" type="xs:string" paramType="variable" />
                <key id="artist" type="xs:string" paramType="variable" />
                <key id="created_at" type="xs:integer" paramType="variable" />
                <key id="location_description" type="xs:string" paramType="variable" />
                <key id="medium" type="xs:string" paramType="variable" />
                <key id="source" type="xs:string" paramType="variable" />
                <key id="title" type="xs:string" paramType="variable" />
            </inputs>
            <execute>
                <![CDATA[
                	var url 		 = request.url,
						multipleKeys = false,
						key, val, ret;

					for (key in inputs) {

						val = inputs[key];

						// Handle unnecessary 'session' input key
      					if (key === 'session') {
							continue;

      					// Add 'AND' statement to URL when we have more than one key
                        } else if (val && multipleKeys) { 
							url += (' AND ' + key + '=\'' + val + '\'');
       
      					// Add '$where' parameter to URL for the first key
                        } else if (val) {
                            url += ('?$where=' + key + '=\'' + val + '\'');
							multipleKeys = true;
                        }
					}

					url = url.replace(new RegExp(' ', 'g'), ' ');
					ret = y.xmlToJson(y.rest(url).get().response);
					response.object = ret.json;
                ]]>
            </execute>
        </select>
     </bindings>
</table>